
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Blog Bom!!BO!">
    <title>Exceptions - Blog Bom!!BO!</title>
    <meta name="author" content="Eddie Lee">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Eddie Lee","sameAs":["https://github.com/RadianceL"],"image":"eddie-personal.jpg"},"articleBody":"在Java程序开发中，会遇到各种异常，常见的NPE(NullPonitException)，AOOI(ArrayOutOfIndexException)等等，Java的优雅之处，很大一部分就在于这些刚开始看着头痛的异常中，一起来了解下\nExceptions首先，什么是异常，通俗来讲，异常，是我们程序出现错误，并无法按照预期执行下去的情况，会抛出一个异常，它会告诉你，某个地方出错了，请示你该如何解决或者修改你的代码。\n那么我们可以简单理解为，这是一个消息，一旦程序遇到问题，它自行无法解决，程序非常忠实于开发者，它不会自己决定该怎么做，此时，程序开始收集信息，比如我在A类执行到118行代码的地方，遇到了一个我无法解决的问题，你设置了循环了10次，但你给我的数组里只有8条数据，我该怎么解决？\n信息收集好了，他还是包装，这里我们遇到的异常是ArrayIndexOutOfBoundsException，给你传递了一个消息:Index: 5, Size: 5，告诉你说，你给了我一个只有5个数据的List，却要我找位置在第6位的数据，数组越界了，同时，他给你带上了异常栈，最上面是这个异常最开始发生的代码所在位置，然后一级一级往外传，每跳出一层，就记录一级的信息，在没有异常处理的情况下，直接跳到main方法中，展示到控制台中，并终止自己。\n了解了异常是什么，来了解下Java 自身的异常体系\nThrowableThrowable就是Java异常体系的起点，基于所有Java的类都显式或隐式的继承于Object类，所以说异常体系的Root对象，就是Throwable，Throwabl旗下有两员悍将，Error，Exception。\n其中Error是主战将军，轻易不出手，出手即打残，一旦我们看到Error级别的错误，表示JVM检测到无法预期的错误，因为是JVM导致的错误，并非程序可以改变，所以最多我们可以看到异常信息，无法捕获处理。根据错误去找环境哪里配置的不正确，或者重装一次Java，通常会解决问题\n另外一个Exception类，是相国，相国通常讲究游说之道，哪里不合适我们再谈谈，但这种谈也分强硬方（CheckedException）和弱势方（RunntimeException），第一种是直接继承自Exception，此乃强硬的方式，行也要行，不行也要行，如果你调用的方法中可能抛出这种错，那么你必须在方法调用的地方进行处理，或者选择继续往上抛，否则编译不通过，常见的有IOException。另外一种方式，就很柔和了，但是阴损，这种方式就是继承自RunntimeException的异常，处理不处理都行，你往不往上层抛也行，反正我也不告诉你这块能出异常，你要遇到了就加上异常处理，你要遇不到，就等客户遇到了告诉你。\n下面是一张Throwable的Diagrams图，看不清的朋友右键图片下载到本地放大来看\n自定义异常体系通过上面的调查，已经知道了什么是java的异常体系，那么我们是不是可以基于Java的异常体系来搭建属于我们自己的呢？\n首先我来描述一个我们常见的场景，当我们访问数据库做一些CRUD操作时，经常会碰到一些SQL的错，这些错是无法避免的，我们只能处理，但我们还需要一些其他业务相关的异常，比如一个电商场景，需要先创建企业，在创建商户，创建商户时需要挂在商户上一些必填属性，一旦这些属性为空，数据库将爆出字段不能为空的错误，这个错误如果按照标准处理方法，比如e.getMessage()获取内容，传递给前段的会是一个SQL的错误，但这个错误一定是不能让前台看见的，第一，如果爆出去，会严重影响用户体验以及用户信任度，第二，你的表结构完全暴露给前台，存在安全隐患。\n此时我需要区分，什么错是我们业务异常，什么是数据库异常，如果我们没有自定义异常体系，只能依赖拦截RuntimeException来做是不可能实现上述需求的，那么解决这个首先，我们先创建一个类，假设ElBasicException extend RuntimeException，并实现所需要的构造函数，通常我们不会直接在业务中抛出BasicException，假设我们在控制层做参数校验，检测出某一个参数长度超长，这时候我们可以新建一个异常，命名为ElParameterByteArrayOutOfMaxException，并继承于ElBasicException，抛出这异常，并在全局异常处理器中拦截，判断如果 e instanceof ElBasicException，那么就走我们业务的处理机制，如果不是，那么返回“系统错误“。\n通常按照规范，一个合格的系统，所有的异常都应该是有预期的，也就是不会抛出我们不可预见的错误，预期中的错误，都应该有通用或特殊处理的逻辑来捕获处理，预期外的错误，遇到就需要立即解决，或在异常抛出位置进行转译，但不推荐这么做。\n另外，最好只在必须要抛异常来触发某些操作时抛异常，否则尽量减少抛异常的次数和抛异常的可能，因为我们知道Java的方法调用其实是压栈，方法调用结束就会弹出栈定，如果在方法调用中出现异常，它会记录当前栈的信息，回到上一层，上一层没有捕获继续往上走，每一次弹出栈都会记录一次信息，属于昂贵消耗，尤其我们在Spring项目中，Spring代码调用层次很深，并且在Spring内部不会为你处理异常信息，所以通常spring项目报错，我们会看到很长很长的异常栈信息，新手甚至找不到这个错误信息是由哪个地方引起的。\n所以使用自定义异常体系的原则是，尽量规避使用，如果现有异常体系无法满足业务需要，尽可能少的抛出自定义异常，并在程序编写中 &amp;&amp; 表结构设计中，尽量规避抛出异常的可能。\n","dateCreated":"2019-06-16T15:27:44+08:00","dateModified":"2019-06-16T16:43:21+08:00","datePublished":"2019-06-16T15:27:44+08:00","description":"在Java程序开发中，会遇到各种异常，常见的NPE(NullPonitException)，AOOI(ArrayOutOfIndexException)等等，Java的优雅之处，很大一部分就在于这些刚开始看着头痛的异常中，一起来了解下","headline":"Exceptions","image":["https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=960265520,2932106354&fm=27&gp=0.jpg","http://old.bz55.com/uploads/allimg/150719/139-150GZZ039.jpg"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://radiancel.github.io/2019/06/16/Exceptions/"},"publisher":{"@type":"Organization","name":"Eddie Lee","sameAs":["https://github.com/RadianceL"],"image":"eddie-personal.jpg","logo":{"@type":"ImageObject","url":"eddie-personal.jpg"}},"url":"https://radiancel.github.io/2019/06/16/Exceptions/","keywords":"Java","thumbnailUrl":"https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=960265520,2932106354&fm=27&gp=0.jpg"}</script>
    <meta name="description" content="在Java程序开发中，会遇到各种异常，常见的NPE(NullPonitException)，AOOI(ArrayOutOfIndexException)等等，Java的优雅之处，很大一部分就在于这些刚开始看着头痛的异常中，一起来了解下">
<meta name="keywords" content="Java">
<meta property="og:type" content="blog">
<meta property="og:title" content="Exceptions">
<meta property="og:url" content="https://radiancel.github.io/2019/06/16/Exceptions/index.html">
<meta property="og:site_name" content="Blog Bom!!BO!">
<meta property="og:description" content="在Java程序开发中，会遇到各种异常，常见的NPE(NullPonitException)，AOOI(ArrayOutOfIndexException)等等，Java的优雅之处，很大一部分就在于这些刚开始看着头痛的异常中，一起来了解下">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://radiancel.github.io/2019/06/16/Exceptions/exception-diagrms.png">
<meta property="og:updated_time" content="2019-06-16T08:43:21.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Exceptions">
<meta name="twitter:description" content="在Java程序开发中，会遇到各种异常，常见的NPE(NullPonitException)，AOOI(ArrayOutOfIndexException)等等，Java的优雅之处，很大一部分就在于这些刚开始看着头痛的异常中，一起来了解下">
<meta name="twitter:image" content="https://radiancel.github.io/2019/06/16/Exceptions/exception-diagrms.png">
    
    
        
    
    
        <meta property="og:image" content="https://radiancel.github.io/assets/images/eddie-personal.jpg"/>
    
    
        <meta property="og:image" content="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=960265520,2932106354&amp;fm=27&amp;gp=0.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=960265520,2932106354&amp;fm=27&amp;gp=0.jpg" />
    
    
        <meta property="og:image" content="http://old.bz55.com/uploads/allimg/150719/139-150GZZ039.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="http://old.bz55.com/uploads/allimg/150719/139-150GZZ039.jpg" />
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-c4ozcsklz4kht2pebhp44xorvyverh23toayhn7i6ubrpyedak24hv1v0hyd.min.css">
    <!--STYLES END-->
    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">Blog Bom!!BO!</a>
    </div>
    
        
            <a class="header-right-picture " href="#about">
        
        
            <img class="header-picture" src="/assets/images/eddie-personal.jpg" alt="Author&#39;s picture">
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/eddie-personal.jpg" alt="Author&#39;s picture">
                </a>
                <h4 class="sidebar-profile-name">Eddie Lee</h4>
                
                    <h5 class="sidebar-profile-bio"><p>author.bio</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/ " title="Home">
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-categories" title="Categories">
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-tags" title="Tags">
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-archives" title="Archives">
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="#about" title="About">
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://github.com/RadianceL" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
        <div class="post-header-cover
                    text-left
                    " style="background-image:url('http://old.bz55.com/uploads/allimg/150719/139-150GZZ039.jpg');" data-behavior="4">
            
                <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            Exceptions
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2019-06-16T15:27:44+08:00">
	
		    Jun 16, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Java/">Java</a>


    
</div>

    
</div>

            
        </div>

            <div id="main" data-behavior="4"
                 class="hasCover
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>在Java程序开发中，会遇到各种异常，常见的NPE(NullPonitException)，AOOI(ArrayOutOfIndexException)等等，Java的优雅之处，很大一部分就在于这些刚开始看着头痛的异常中，一起来了解下<br><a id="more"></a></p>
<h1 id="Exceptions"><a href="#Exceptions" class="headerlink" title="Exceptions"></a>Exceptions</h1><p>首先，什么是异常，通俗来讲，异常，是我们程序出现错误，并无法按照预期执行下去的情况，会抛出一个异常，它会告诉你，某个地方出错了，请示你该如何解决或者修改你的代码。</p>
<p>那么我们可以简单理解为，这是一个消息，一旦程序遇到问题，它自行无法解决，程序非常忠实于开发者，它不会自己决定该怎么做，此时，程序开始收集信息，比如我在A类执行到118行代码的地方，遇到了一个我无法解决的问题，你设置了循环了10次，但你给我的数组里只有8条数据，我该怎么解决？</p>
<p>信息收集好了，他还是包装，这里我们遇到的异常是ArrayIndexOutOfBoundsException，给你传递了一个消息:<code>Index: 5, Size: 5</code>，告诉你说，你给了我一个只有5个数据的List，却要我找位置在第6位的数据，数组越界了，同时，他给你带上了异常栈，最上面是这个异常最开始发生的代码所在位置，然后一级一级往外传，每跳出一层，就记录一级的信息，在没有异常处理的情况下，直接跳到main方法中，展示到控制台中，并终止自己。</p>
<p>了解了异常是什么，来了解下Java 自身的异常体系</p>
<h1 id="Throwable"><a href="#Throwable" class="headerlink" title="Throwable"></a>Throwable</h1><p>Throwable就是Java异常体系的起点，基于所有Java的类都显式或隐式的继承于Object类，所以说异常体系的Root对象，就是Throwable，Throwabl旗下有两员悍将，Error，Exception。</p>
<p>其中Error是主战将军，轻易不出手，出手即打残，一旦我们看到Error级别的错误，表示JVM检测到无法预期的错误，因为是JVM导致的错误，并非程序可以改变，所以最多我们可以看到异常信息，无法捕获处理。根据错误去找环境哪里配置的不正确，或者重装一次Java，通常会解决问题</p>
<p>另外一个Exception类，是相国，相国通常讲究游说之道，哪里不合适我们再谈谈，但这种谈也分强硬方（CheckedException）和弱势方（RunntimeException），第一种是直接继承自Exception，此乃强硬的方式，行也要行，不行也要行，如果你调用的方法中可能抛出这种错，那么你必须在方法调用的地方进行处理，或者选择继续往上抛，否则编译不通过，常见的有IOException。另外一种方式，就很柔和了，但是阴损，这种方式就是继承自RunntimeException的异常，处理不处理都行，你往不往上层抛也行，反正我也不告诉你这块能出异常，你要遇到了就加上异常处理，你要遇不到，就等客户遇到了告诉你。</p>
<p>下面是一张Throwable的Diagrams图，看不清的朋友右键图片下载到本地放大来看<br><img src="/2019/06/16/Exceptions/exception-diagrms.png" alt="描述"></p>
<h1 id="自定义异常体系"><a href="#自定义异常体系" class="headerlink" title="自定义异常体系"></a>自定义异常体系</h1><p>通过上面的调查，已经知道了什么是java的异常体系，那么我们是不是可以基于Java的异常体系来搭建属于我们自己的呢？</p>
<p>首先我来描述一个我们常见的场景，当我们访问数据库做一些CRUD操作时，经常会碰到一些SQL的错，这些错是无法避免的，我们只能处理，但我们还需要一些其他业务相关的异常，比如一个电商场景，需要先创建企业，在创建商户，创建商户时需要挂在商户上一些必填属性，一旦这些属性为空，数据库将爆出字段不能为空的错误，这个错误如果按照标准处理方法，比如e.getMessage()获取内容，传递给前段的会是一个SQL的错误，但这个错误一定是不能让前台看见的，第一，如果爆出去，会严重影响用户体验以及用户信任度，第二，你的表结构完全暴露给前台，存在安全隐患。</p>
<p>此时我需要区分，什么错是我们业务异常，什么是数据库异常，如果我们没有自定义异常体系，只能依赖拦截RuntimeException来做是不可能实现上述需求的，那么解决这个首先，我们先创建一个类，假设ElBasicException extend RuntimeException，并实现所需要的构造函数，通常我们不会直接在业务中抛出BasicException，假设我们在控制层做参数校验，检测出某一个参数长度超长，这时候我们可以新建一个异常，命名为ElParameterByteArrayOutOfMaxException，并继承于ElBasicException，抛出这异常，并在全局异常处理器中拦截，判断如果 e instanceof ElBasicException，那么就走我们业务的处理机制，如果不是，那么返回“系统错误“。</p>
<p>通常按照规范，一个合格的系统，所有的异常都应该是有预期的，也就是不会抛出我们不可预见的错误，预期中的错误，都应该有通用或特殊处理的逻辑来捕获处理，预期外的错误，遇到就需要立即解决，或在异常抛出位置进行转译，但不推荐这么做。</p>
<p>另外，最好只在必须要抛异常来触发某些操作时抛异常，否则尽量减少抛异常的次数和抛异常的可能，因为我们知道Java的方法调用其实是压栈，方法调用结束就会弹出栈定，如果在方法调用中出现异常，它会记录当前栈的信息，回到上一层，上一层没有捕获继续往上走，每一次弹出栈都会记录一次信息，属于昂贵消耗，尤其我们在Spring项目中，Spring代码调用层次很深，并且在Spring内部不会为你处理异常信息，所以通常spring项目报错，我们会看到很长很长的异常栈信息，新手甚至找不到这个错误信息是由哪个地方引起的。</p>
<p>所以使用自定义异常体系的原则是，尽量规避使用，如果现有异常体系无法满足业务需要，尽可能少的抛出自定义异常，并在程序编写中 &amp;&amp; 表结构设计中，尽量规避抛出异常的可能。</p>

            

        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/Java/">Java</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/07/10/Spring-State-Machine/" data-tooltip="Spring State Machine" aria-label="PREVIOUS: Spring State Machine">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/03/31/spring-cloud-prod/" data-tooltip="spring-cloud-prod" aria-label="NEXT: spring-cloud-prod">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2019 Eddie Lee. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/07/10/Spring-State-Machine/" data-tooltip="Spring State Machine" aria-label="PREVIOUS: Spring State Machine">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/03/31/spring-cloud-prod/" data-tooltip="spring-cloud-prod" aria-label="NEXT: spring-cloud-prod">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                

            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/eddie-personal.jpg" alt="Author&#39;s picture">
        
            <h4 id="about-card-name">Eddie Lee</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br>
                <p>author.job</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br>
                LN
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-dbd16rvloemmuxdzniplmnxxvwoz24eya9wol0b7vvmlokgqsjivmb8dnscy.min.js"></script>
<!--SCRIPTS END-->

    



    </body>
</html>
